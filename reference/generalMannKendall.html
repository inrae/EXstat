<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>General Mann-Kendall — generalMannKendall • EXstat</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="General Mann-Kendall — generalMannKendall"><meta name="description" content="A general version of the Mann-Kendall test, enabling
various dependence assumptions."><meta property="og:description" content="A general version of the Mann-Kendall test, enabling
various dependence assumptions."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EXstat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.4.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Explore2_flow_statistics.html">Hydrological indicator calculations</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>General Mann-Kendall</h1>

      <div class="d-none name"><code>generalMannKendall.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A general version of the Mann-Kendall test, enabling
various dependence assumptions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">generalMannKendall</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  dep.option <span class="op">=</span> <span class="st">"INDE"</span>,</span>
<span>  DoDetrending <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>numeric vector, data. IMPORTANT: X is assumed to be
regularly-spaced. It uses NA to fill the gaps rather than removing
missing values.</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>numeric in (0,1), level of the test.</p></dd>


<dt id="arg-dep-option">dep.option<a class="anchor" aria-label="anchor" href="#arg-dep-option"></a></dt>
<dd><p>string, option for handling temporal dependence.
Available :</p><ol><li><p>'INDE', assume independence (i.e. the standard MK test)</p></li>
<li><p>'AR1', assumes AR1 short-term dependence structure (i.e.
Hamed and Rao's version of the MK test)</p></li>
<li><p>'LTP', assume long-term persistence (i.e. Hamed's version
of the MK test)</p></li>
</ol></dd>


<dt id="arg-dodetrending-">DoDetrending, <a class="anchor" aria-label="anchor" href="#arg-dodetrending-"></a></dt>
<dd><p>logical, only used for dep.option == LTP:
do detrending before estimating Hurst coefficient (default=TRUE as
recommended in Hamed's paper)</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> Whether to print intermediate messages. Default is <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with the following fields :</p><ol><li><p>H: logical, reject (true) or do not reject (false) H0</p></li>
<li><p>P: p-value of the test</p></li>
<li><p>STAT: test statistics</p></li>
<li><p>TREND: trend estimate (using Sen's slope estimate)</p></li>
<li><p>DEP: dependence estimate (= 0 if dep.option='INDE',
=lag-1 autocorrelation if dep.option='AR1', =Hurst coefficient if
dep.option='LTP')</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<ol><li><p>Handling of ties: Specific formula exist for INDE and
AR1, but the LTP case is trickier. Hammed's paper is unclear on how
to handle ties, especially at the step of Hurst coefficient
estimation. There is a normal-score transformation at this step,
and one needs to decide how to assign a rank to ties. What is
implemented below is the option ties.method = "random", i.e. the
rank is randomized for ties. This is not, strictly speaking,
correct because this randomization impacts the dependence
structure. However synthetic runs suggest it works OK.</p></li>
<li><p>Computational efficiency: Likely poor for case
dep.option='LTP'. There is a 4-level loop which leads to a n^4
algorithm. I attempted to vectorize this loop but it didn't improve
things =&gt; Expect significant running times for dep.option='LTP
' when size(X) &gt; 50... (orders of magnitude: 1s for n=30, 10s for
n=50, 2-3 minutes for n=100). On the other hand both options INDE
and AR1 are very fast.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ol><li><p>Hamed, Rao, 1998. A modified Mann-Kendall trend test for
autocorrelated data. J. Hydrol., 204(1-4): 182-196.</p></li>
<li><p>Hamed, 2008. Trend detection in hydrologic data: The
Mann-Kendall trend test under the scaling hypothesis. J. Hydrol.,
349(3-4): 350-363.</p></li>
</ol></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">nhtemp</span><span class="op">)</span> <span class="co">#Average Yearly Temperatures in New Haven</span></span></span>
<span class="r-in"><span><span class="fu">generalMannKendall</span><span class="op">(</span>X<span class="op">=</span><span class="va">nhtemp</span>, dep.option<span class="op">=</span><span class="st">'AR1'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Benjamin Renard, Valentin Mansanarez, Louis Héraut.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

